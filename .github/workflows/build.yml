name: Build Xiaomi Kernel (veux-r-oss, Clang)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      ARCH: arm64
      SUBARCH: arm64
      DEFCONFIG: defconfig
      KBUILD_BUILD_USER: github
      KBUILD_BUILD_HOST: runner
      

    steps:
    - name: Checkout This Repo
      uses: actions/checkout@v4
      with:
        fetch-depth: 1

    - name: Install Dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y bc bison flex libssl-dev \
          libncurses5-dev libelf-dev ccache curl unzip \
          python3 python-is-python3 git make wget

    - name: Android kernel build
      uses: lemniskett/android-kernel-actions@master
      id: build
      env:
        NAME: Loganysl
      with:
        arch: arm64
        compiler: compiler_version
        defconfig: defconfig
        image: Image.gz-dtb

    - name: Upload Image.gz-dtb
      uses: actions/upload-artifact@v4
      with:
        name: Image.gz-dtb
        path: out/arch/arm64/boot/Image.gz-dtb
