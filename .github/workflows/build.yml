name: Build Xiaomi Kernel (veux-r-oss, Clang)

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      ARCH: arm64
      SUBARCH: arm64
      DEFCONFIG: veux
      KBUILD_BUILD_USER: github
      KBUILD_BUILD_HOST: runner

    steps:
    # - name: Checkout This Repo
    #   uses: actions/checkout@v4
    #   with:
    #     repository: lenonarddo/XiaomiKernel

    # - name: Build config
    #   run: | 
    #     mkdir out
    #     make O=out ARCH=arm64 veux
    - name: build
      run: |
        ls ./
        cd XiaomiKernel/
        mkdir out/ 
        make O=./out ARCH=arm64 veux
        
    - name: Android kernel build
      uses: lemniskett/android-kernel-actions@master
      id: build
      env:
        NAME: Dark-Ages-Ãšltimo
      with:
        repository: lenonarddo/XiaomiKernel
        arch: arm64
        compiler: clang/14
        defconfig: veux
        image: Image.gz
        

    - name: Upload Image.gz-dtb
      uses: actions/upload-artifact@v4
      with:
        name: Image.gz
        path: Image.gz
